<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Estat√≠sticas do Guigaum - Steam Analytics</title>
    <meta name="description" content="Estat√≠sticas em tempo real do perfil Steam do Guigaum com compara√ß√µes divertidas!">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="/manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #171a21;
            --secondary: #1b2838;
            --accent: #66c0f4;
            --accent-dark: #4ca0d4;
            --text: #c6d4df;
            --highlight: #ffcc66;
            --highlight-dark: #e6b855;
            --card-bg: rgba(27, 40, 56, 0.9);
            --success: #5ba32b;
            --warning: #e6a338;
            --danger: #e53935;
            --purple: #9147ff;
            --orange: #ff6b35;
        }

        body {
            background-color: var(--primary);
            color: var(--text);
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(102, 192, 244, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 80% 70%, rgba(255, 204, 102, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 40% 80%, rgba(147, 71, 255, 0.1) 0%, transparent 25%),
                linear-gradient(to bottom, var(--primary), var(--secondary));
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(102, 192, 244, 0.05) 0%, transparent 10%),
                radial-gradient(circle at 90% 80%, rgba(255, 204, 102, 0.05) 0%, transparent 10%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header Estilizado */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            border-radius: 20px;
            background: linear-gradient(135deg, var(--card-bg) 0%, rgba(23, 26, 33, 0.9) 100%);
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(102, 192, 244, 0.2);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), var(--highlight), var(--purple));
        }

        .profile-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .avatar-container {
            position: relative;
        }

        .avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 4px solid var(--accent);
            box-shadow: 
                0 0 30px rgba(102, 192, 244, 0.4),
                0 0 60px rgba(102, 192, 244, 0.2);
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.05);
        }

        .online-status {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid var(--primary);
        }

        .status-online { background: var(--success); }
        .status-ingame { background: var(--warning); }
        .status-offline { background: #8f98a0; }

        .profile-info {
            text-align: left;
            flex: 1;
            min-width: 300px;
        }

        h1 {
            color: var(--accent);
            font-size: 3.2rem;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            background: linear-gradient(90deg, var(--accent), var(--highlight));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .steam-id {
            color: var(--highlight);
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            background: rgba(0, 0, 0, 0.4);
            padding: 8px 15px;
            border-radius: 8px;
            display: inline-block;
            border: 1px solid rgba(255, 204, 102, 0.2);
        }

        .profile-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            margin-bottom: 10px;
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }

        .status-online-text { color: var(--success); }
        .status-ingame-text { color: var(--warning); }
        .status-offline-text { color: #8f98a0; }

        .last-updated {
            color: #8f98a0;
            font-size: 0.95rem;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        /* Controles */
        .controls {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 28px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: var(--primary);
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(102, 192, 244, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 192, 244, 0.4);
        }

        button#refreshBtn {
            background: linear-gradient(135deg, var(--secondary), #2a3f5a);
            color: var(--text);
            border: 1px solid var(--accent);
        }

        button#refreshBtn:hover {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: var(--primary);
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            margin: 40px 0;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .loading-content {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .loading-spinner {
            font-size: 2.5rem;
            color: var(--accent);
            animation: spin 1.5s linear infinite, pulse 2s infinite;
        }

        .loading-bar {
            width: 200px;
            height: 4px;
            background: rgba(102, 192, 244, 0.2);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--highlight));
            animation: loading 2s ease-in-out infinite;
            width: 60%;
        }

        @keyframes loading {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(200%); }
        }

        /* Grid de Estat√≠sticas */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--card-bg) 0%, rgba(23, 26, 33, 0.9) 100%);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s ease;
            border: 1px solid rgba(102, 192, 244, 0.15);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), transparent);
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(102, 192, 244, 0.2);
        }

        .stat-card h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(102, 192, 244, 0.2);
        }

        .stat-card h3 i {
            color: var(--highlight);
            font-size: 1.8rem;
            width: 40px;
            text-align: center;
        }

        .stat-value {
            font-size: 3.2rem;
            font-weight: 800;
            color: white;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            line-height: 1;
        }

        .stat-value.small {
            font-size: 2.5rem;
        }

        .stat-description {
            font-size: 1.05rem;
            line-height: 1.6;
            color: #a0b4c5;
        }

        .highlight {
            color: var(--highlight);
            font-weight: bold;
            background: rgba(255, 204, 102, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Jogos */
        .games-list {
            grid-column: 1 / -1;
        }

        .games-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .game-item {
            background: rgba(23, 26, 33, 0.7);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .game-item:hover {
            background: rgba(33, 38, 48, 0.9);
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .game-img {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            background: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--accent);
            overflow: hidden;
            flex-shrink: 0;
        }

        .game-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .game-info {
            flex: 1;
            min-width: 0;
        }

        .game-name {
            font-weight: bold;
            color: white;
            margin-bottom: 8px;
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .game-hours {
            color: var(--highlight);
            font-weight: bold;
            font-size: 1.3rem;
            margin-bottom: 10px;
        }

        /* Curiosidades */
        .fun-facts-section {
            margin: 60px 0;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 40px;
            color: var(--accent);
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            right: 25%;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
        }

        .fun-facts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .fun-fact-card {
            background: linear-gradient(135deg, rgba(27, 40, 56, 0.8), rgba(33, 47, 65, 0.8));
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            border: 1px solid rgba(102, 192, 244, 0.1);
            position: relative;
            overflow: hidden;
        }

        .fun-fact-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(102, 192, 244, 0.05) 100%);
            z-index: 0;
        }

        .fun-fact-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .fun-fact-card h4 {
            color: var(--highlight);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .fun-fact-card h4 i {
            color: var(--accent);
            font-size: 1.5rem;
        }

        .fun-fact-card p {
            color: #b0c4d5;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .fun-fact-icon {
            position: absolute;
            bottom: 15px;
            right: 15px;
            font-size: 3rem;
            color: rgba(102, 192, 244, 0.1);
            z-index: 0;
        }

        /* API Status */
        .api-status-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .api-status {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .api-status-active {
            background: rgba(91, 163, 43, 0.2);
            color: var(--success);
            border: 1px solid rgba(91, 163, 43, 0.4);
            box-shadow: 0 0 20px rgba(91, 163, 43, 0.2);
        }

        .api-status-error {
            background: rgba(229, 57, 53, 0.2);
            color: var(--danger);
            border: 1px solid rgba(229, 57, 53, 0.4);
        }

        .api-status-warning {
            background: rgba(230, 163, 56, 0.2);
            color: var(--warning);
            border: 1px solid rgba(230, 163, 56, 0.4);
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 80px;
            padding: 40px 20px;
            color: #8f98a0;
            font-size: 0.95rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            background: rgba(23, 26, 33, 0.6);
            backdrop-filter: blur(10px);
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--accent);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.3s ease;
        }

        .footer-link:hover {
            color: var(--highlight);
        }

        /* Anima√ß√µes */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .games-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-info {
                text-align: center;
                min-width: auto;
            }
            
            .avatar {
                width: 120px;
                height: 120px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .fun-facts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .stat-value {
                font-size: 2.5rem;
            }
            
            .game-item {
                flex-direction: column;
                text-align: center;
            }
            
            .game-img {
                margin-bottom: 15px;
            }
            
            .section-title {
                font-size: 2rem;
            }
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-toggle button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            padding: 0;
            justify-content: center;
            background: var(--card-bg);
            border: 1px solid var(--accent);
        }

        /* Progress Bars */
        .skill-bar {
            margin: 15px 0;
        }

        .skill-name {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .skill-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .skill-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--highlight));
            border-radius: 4px;
            transition: width 1s ease-out;
        }
    </style>
</head>
<body>
    <div class="theme-toggle">
        <button id="themeToggle" title="Alternar tema">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <div class="container">
        <header>
            <div class="profile-header">
                <div class="avatar-container">
                    <img src="" alt="Avatar do Guigaum" class="avatar" id="avatar">
                    <div class="online-status" id="onlineStatus"></div>
                </div>
                <div class="profile-info">
                    <h1 id="profileName">Guigaum</h1>
                    <div class="steam-id" id="steamId">76561198023046376</div>
                    <div class="profile-status" id="profileStatus">
                        <i class="fas fa-circle status-offline-text"></i>
                        <span id="statusText">Carregando status...</span>
                    </div>
                    <div class="last-updated" id="lastUpdated">
                        <i class="fas fa-clock"></i>
                        <span>√öltima atualiza√ß√£o: --</span>
                    </div>
                </div>
            </div>
            
            <div class="api-status-container">
                <div class="api-status api-status-active" id="apiStatus">
                    <i class="fas fa-wifi"></i>
                    <span>API: Conectando...</span>
                </div>
            </div>
            
            <div class="controls">
                <button id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> Atualizar Dados
                </button>
                <a href="https://steamcommunity.com/profiles/76561198023046376/" target="_blank" class="footer-link">
                    <button id="steamProfileBtn">
                        <i class="fab fa-steam"></i> Ver Perfil na Steam
                    </button>
                </a>
                <button id="shareBtn">
                    <i class="fas fa-share-alt"></i> Compartilhar
                </button>
            </div>
        </header>

        <div class="loading" id="loading">
            <div class="loading-content">
                <i class="fas fa-spinner loading-spinner"></i>
                <div>Buscando dados reais do Guigaum...</div>
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
                <div id="loadingStatus" style="font-size: 0.9rem; color: var(--accent);">Conectando √† Steam API...</div>
            </div>
        </div>

        <div class="error-message" id="errorMessage" style="display: none;">
            <strong><i class="fas fa-exclamation-triangle"></i> Erro:</strong> <span id="errorText"></span>
        </div>

        <div class="stats-grid" id="statsGrid">
            <!-- Estat√≠sticas ser√£o geradas aqui -->
        </div>

        <div class="fun-facts-section">
            <h2 class="section-title">üéØ Curiosidades Divertidas</h2>
            <div class="fun-facts-grid" id="funFactsGrid">
                <!-- Curiosidades ser√£o geradas aqui -->
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <p><i class="fas fa-info-circle"></i> Esta p√°gina usa a API oficial da Steam para buscar dados em tempo real do perfil do Guigaum</p>
                <p>Os dados s√£o atualizados automaticamente a cada 10 minutos</p>
                
                <div class="footer-links">
                    <a href="https://github.com/jow320/guigaumhours" target="_blank" class="footer-link">
                        <i class="fab fa-github"></i> C√≥digo no GitHub
                    </a>
                    <a href="https://steamcommunity.com/dev" target="_blank" class="footer-link">
                        <i class="fab fa-steam"></i> Steam Web API
                    </a>
                    <button id="clearCacheBtn" class="footer-link" style="background: none; border: none; color: var(--accent); cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Limpar Cache
                    </button>
                </div>
                
                <p><strong>üéÆ Steam ID:</strong> 76561198023046376 | <strong>üïê Atualiza√ß√£o:</strong> <span id="cacheInfo">Carregando...</span></p>
                <p style="margin-top: 15px; font-size: 0.85rem; opacity: 0.7;">
                    <i class="fas fa-shield-alt"></i> Esta p√°gina usa cache local para reduzir requisi√ß√µes √† API Steam
                </p>
            </div>
        </footer>
    </div>

    <script>
        // Configura√ß√µes
        const STEAM_ID = "76561198023046376";
        const STEAM_API_KEY = "B263B41F91D223C8435CD498D775CACF";
        const PROFILE_URL = "https://steamcommunity.com/profiles/76561198023046376/";
        
        // M√∫ltiplos proxies CORS como fallback
        const PROXIES = [
            {
                name: "allorigins",
                url: "https://api.allorigins.win/get?url=",
                parser: (data) => JSON.parse(data.contents)
            },
            {
                name: "corsproxy",
                url: "https://corsproxy.io/?",
                parser: (data) => data
            },
            {
                name: "codetabs",
                url: "https://api.codetabs.com/v1/proxy?quest=",
                parser: (data) => data
            }
        ];
        
        // Cache configuration
        const CACHE_CONFIG = {
            profile: { ttl: 5 * 60 * 1000 }, // 5 minutos
            games: { ttl: 10 * 60 * 1000 },  // 10 minutos
            stats: { ttl: 15 * 60 * 1000 }   // 15 minutos
        };
        
        // Dados de exemplo para fallback
        const SAMPLE_DATA = {
            profile: {
                personaname: "Guigaum",
                avatarfull: "https://avatars.steamstatic.com/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg",
                personastate: 0,
                gameextrainfo: null
            },
            games: {
                total_count: 4,
                games: [
                    { name: "Counter-Strike 2", playtime_2weeks: 420, appid: 730, playtime_forever: 1500 },
                    { name: "Dota 2", playtime_2weeks: 300, appid: 570, playtime_forever: 2500 },
                    { name: "Apex Legends", playtime_2weeks: 180, appid: 1172470, playtime_forever: 800 },
                    { name: "Team Fortress 2", playtime_2weeks: 90, appid: 440, playtime_forever: 1200 }
                ]
            }
        };
        
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos DOM
            const elements = {
                avatar: document.getElementById('avatar'),
                profileName: document.getElementById('profileName'),
                steamId: document.getElementById('steamId'),
                profileStatus: document.getElementById('profileStatus'),
                statusText: document.getElementById('statusText'),
                onlineStatus: document.getElementById('onlineStatus'),
                lastUpdated: document.getElementById('lastUpdated'),
                apiStatus: document.getElementById('apiStatus'),
                refreshBtn: document.getElementById('refreshBtn'),
                loading: document.getElementById('loading'),
                loadingStatus: document.getElementById('loadingStatus'),
                errorMessage: document.getElementById('errorMessage'),
                errorText: document.getElementById('errorText'),
                statsGrid: document.getElementById('statsGrid'),
                funFactsGrid: document.getElementById('funFactsGrid'),
                themeToggle: document.getElementById('themeToggle'),
                clearCacheBtn: document.getElementById('clearCacheBtn'),
                shareBtn: document.getElementById('shareBtn'),
                cacheInfo: document.getElementById('cacheInfo')
            };
            
            // Estado da aplica√ß√£o
            let appState = {
                currentProxy: 0,
                isOnline: navigator.onLine,
                lastFetchTime: null,
                useFallback: false
            };
            
            // Configurar elementos iniciais
            elements.steamId.textContent = STEAM_ID;
            
            // Verificar conex√£o
            window.addEventListener('online', () => {
                appState.isOnline = true;
                updateApiStatus('online', 'Conectado √† internet');
            });
            
            window.addEventListener('offline', () => {
                appState.isOnline = false;
                updateApiStatus('error', 'Sem conex√£o com a internet');
                showError('Voc√™ est√° offline. Mostrando dados do cache...');
                loadCachedData();
            });
            
            // Sistema de Cache Local
            const cache = {
                set: (key, data, ttl = 5 * 60 * 1000) => {
                    const item = {
                        data: data,
                        expiry: Date.now() + ttl,
                        timestamp: Date.now()
                    };
                    try {
                        localStorage.setItem(`guigaum_${key}`, JSON.stringify(item));
                        console.log(`Cache salvo para ${key}`);
                    } catch (e) {
                        console.error('Erro ao salvar cache:', e);
                    }
                },
                
                get: (key) => {
                    try {
                        const itemStr = localStorage.getItem(`guigaum_${key}`);
                        if (!itemStr) return null;
                        
                        const item = JSON.parse(itemStr);
                        if (Date.now() > item.expiry) {
                            localStorage.removeItem(`guigaum_${key}`);
                            return null;
                        }
                        
                        return item.data;
                    } catch (e) {
                        console.error('Erro ao ler cache:', e);
                        return null;
                    }
                },
                
                clear: () => {
                    const keys = Object.keys(localStorage);
                    keys.forEach(key => {
                        if (key.startsWith('guigaum_')) {
                            localStorage.removeItem(key);
                        }
                    });
                    updateCacheInfo();
                    showNotification('Cache limpo com sucesso!');
                },
                
                getInfo: () => {
                    const keys = Object.keys(localStorage);
                    const cacheKeys = keys.filter(k => k.startsWith('guigaum_'));
                    return {
                        count: cacheKeys.length,
                        size: JSON.stringify(localStorage).length
                    };
                }
            };
            
            // Fun√ß√µes utilit√°rias
            function formatDate(date) {
                return date.toLocaleString('pt-BR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            
            function formatHours(hours) {
                return hours.toFixed(1).replace('.', ',');
            }
            
            function updateApiStatus(type, message) {
                elements.apiStatus.className = `api-status api-status-${type}`;
                elements.apiStatus.innerHTML = `<i class="fas fa-${type === 'active' ? 'wifi' : 'exclamation-triangle'}"></i><span>${message}</span>`;
            }
            
            function showError(message) {
                elements.errorText.textContent = message;
                elements.errorMessage.style.display = 'block';
                setTimeout(() => {
                    elements.errorMessage.style.display = 'none';
                }, 5000);
            }
            
            function showNotification(message) {
                // Cria notifica√ß√£o simples
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--success);
                    color: white;
                    padding: 15px 25px;
                    border-radius: 10px;
                    z-index: 10000;
                    animation: slideIn 0.3s ease;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                `;
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
            
            // Sistema de requisi√ß√µes com fallback
            async function fetchWithFallback(url, cacheKey) {
                // Primeiro tenta o cache
                if (cacheKey) {
                    const cached = cache.get(cacheKey);
                    if (cached) {
                        console.log(`Usando cache para ${cacheKey}`);
                        return cached;
                    }
                }
                
                // Tenta cada proxy at√© um funcionar
                for (let i = 0; i < PROXIES.length; i++) {
                    const proxy = PROXIES[(appState.currentProxy + i) % PROXIES.length];
                    elements.loadingStatus.textContent = `Tentando proxy: ${proxy.name}...`;
                    
                    try {
                        const proxyUrl = proxy.url + encodeURIComponent(url);
                        const response = await fetch(proxyUrl, { timeout: 10000 });
                        
                        if (!response.ok) throw new Error(`HTTP ${response.status}`);
                        
                        const data = await response.json();
                        const parsedData = proxy.parser(data);
                        
                        // Salva no cache se for v√°lido
                        if (cacheKey && parsedData) {
                            cache.set(cacheKey, parsedData, CACHE_CONFIG[cacheKey]?.ttl);
                        }
                        
                        // Rotaciona proxy para pr√≥xima vez
                        appState.currentProxy = (appState.currentProxy + 1) % PROXIES.length;
                        
                        return parsedData;
                        
                    } catch (error) {
                        console.log(`Proxy ${proxy.name} falhou:`, error);
                        continue;
                    }
                }
                
                throw new Error('Todos os proxies falharam');
            }
            
            // Buscar dados da Steam
            async function fetchSteamData() {
                if (!appState.isOnline) {
                    showError('Sem conex√£o com a internet. Usando dados do cache...');
                    loadCachedData();
                    return;
                }
                
                elements.loading.style.display = 'block';
                elements.errorMessage.style.display = 'none';
                appState.useFallback = false;
                
                try {
                    elements.loadingStatus.textContent = 'Buscando perfil...';
                    
                    // Buscar perfil
                    const profileUrl = `https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v2/?key=${STEAM_API_KEY}&steamids=${STEAM_ID}`;
                    const profileData = await fetchWithFallback(profileUrl, 'profile');
                    
                    if (!profileData.response?.players?.[0]) {
                        throw new Error('Perfil n√£o encontrado');
                    }
                    
                    const player = profileData.response.players[0];
                    
                    elements.loadingStatus.textContent = 'Buscando jogos recentes...';
                    
                    // Buscar jogos
                    const gamesUrl = `https://api.steampowered.com/IPlayerService/GetRecentlyPlayedGames/v1/?key=${STEAM_API_KEY}&steamid=${STEAM_ID}`;
                    const gamesData = await fetchWithFallback(gamesUrl, 'games');
                    
                    appState.lastFetchTime = new Date();
                    updateApiStatus('active', 'API: Conectada com sucesso');
                    
                    // Processar e exibir dados
                    displayProfileInfo(player);
                    processAndDisplayStats(player, gamesData);
                    updateCacheInfo();
                    
                } catch (error) {
                    console.error('Erro ao buscar dados:', error);
                    appState.useFallback = true;
                    updateApiStatus('warning', 'API: Usando dados de backup');
                    showError(`Erro na API: ${error.message}. Usando dados de backup...`);
                    useFallbackData();
                } finally {
                    elements.loading.style.display = 'none';
                }
            }
            
            // Exibir informa√ß√µes do perfil
            function displayProfileInfo(player) {
                // Avatar
                if (player.avatarfull) {
                    elements.avatar.src = player.avatarfull;
                    elements.avatar.onerror = () => {
                        elements.avatar.src = 'https://avatars.steamstatic.com/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg';
                    };
                }
                
                // Nome
                elements.profileName.textContent = player.personaname;
                
                // Status
                let status = 'offline';
                let statusClass = 'status-offline-text';
                let statusIcon = 'fa-circle';
                let gamePlaying = null;
                
                if (player.personastate === 1) {
                    status = 'online';
                    statusClass = 'status-online-text';
                } else if (player.personastate === 3) {
                    status = 'ausente';
                } else if (player.personastate === 4) {
                    status = 'dormindo';
                } else if (player.personastate === 6) {
                    status = 'quer trocar';
                    statusClass = 'status-online-text';
                    statusIcon = 'fa-shopping-cart';
                }
                
                if (player.gameextrainfo) {
                    status = 'em jogo';
                    statusClass = 'status-ingame-text';
                    statusIcon = 'fa-gamepad';
                    gamePlaying = player.gameextrainfo;
                }
                
                elements.statusText.textContent = gamePlaying ? `Jogando ${gamePlaying}` : status;
                elements.profileStatus.innerHTML = `<i class="fas ${statusIcon} ${statusClass}"></i><span id="statusText">${elements.statusText.textContent}</span>`;
                elements.onlineStatus.className = `online-status ${status === 'em jogo' ? 'status-ingame' : status === 'online' ? 'status-online' : 'status-offline'}`;
                
                // Atualizar timestamp
                elements.lastUpdated.innerHTML = `<i class="fas fa-clock"></i><span>√öltima atualiza√ß√£o: ${formatDate(new Date())}</span>`;
            }
            
            // Processar estat√≠sticas
            function processAndDisplayStats(player, gamesData) {
                const games = gamesData.response?.games || [];
                const totalHours = games.reduce((sum, game) => sum + (game.playtime_2weeks || 0) / 60, 0);
                
                // Salvar estat√≠sticas no cache
                const stats = {
                    totalHours,
                    gameCount: games.length,
                    topGame: games[0] || null,
                    timestamp: Date.now()
                };
                cache.set('stats', stats, CACHE_CONFIG.stats.ttl);
                
                // Exibir estat√≠sticas
                displayStats(totalHours, games);
                displayFunFacts(totalHours, games);
            }
            
            // Exibir estat√≠sticas principais
            function displayStats(totalHours, games) {
                elements.statsGrid.innerHTML = '';
                
                // Calcular m√©tricas
                const avgHoursPerDay = totalHours / 14;
                const workDaysEquivalent = totalHours / 8;
                const weeklyHours = totalHours / 2;
                const percentOfDay = (avgHoursPerDay / 24) * 100;
                const monthlyProjection = avgHoursPerDay * 30;
                
                // 1. Estat√≠stica Principal
                elements.statsGrid.appendChild(createStatCard(
                    'fa-clock',
                    'Horas Totais (2 semanas)',
                    `<div class="stat-value">${formatHours(totalHours)}h</div>`,
                    `Total de horas que <span class="highlight">Guigaum</span> jogou na Steam nas √∫ltimas 2 semanas. Obs: Ele ainda joga no <span class="highlight">domingo na madrugada.</span>`,
                    totalHours > 100 ? 'warning' : ''
                ));
                
                // 2. M√©dia Di√°ria
                elements.statsGrid.appendChild(createStatCard(
                    'fa-calendar-day',
                    'M√©dia Di√°ria',
                    `<div class="stat-value">${formatHours(avgHoursPerDay)}h/dia</div>`,
                    `Isso representa <span class="highlight">${percentOfDay.toFixed(1)}%</span> de um dia inteiro.`,
                    ''
                ));
                
                // 3. Equivalente em Trabalho
                elements.statsGrid.appendChild(createStatCard(
                    'fa-briefcase',
                    'Dias de Trabalho',
                    `<div class="stat-value">${workDaysEquivalent.toFixed(1)} dias</div>`,
                    `Equivalente a <span class="highlight">${workDaysEquivalent.toFixed(1)}</span> dias de trabalho (8h/dia).`,
                    workDaysEquivalent >= 5 ? 'warning' : ''
                ));
                
                // 4. Proje√ß√£o Mensal
                elements.statsGrid.appendChild(createStatCard(
                    'fa-chart-line',
                    'Proje√ß√£o Mensal',
                    `<div class="stat-value">${Math.round(monthlyProjection)}h</div>`,
                    `Se mantiver o ritmo, jogar√° <span class="highlight">${Math.round(monthlyProjection)}h</span> este m√™s.`,
                    ''
                ));
                
                // 5. Compara√ß√£o com Recomenda√ß√µes
                let recommendation = 'Abaixo da m√©dia';
                let recClass = 'success';
                if (weeklyHours > 20) {
                    recommendation = 'Acima do recomendado';
                    recClass = 'warning';
                } else if (weeklyHours > 10) {
                    recommendation = 'Dentro da m√©dia';
                    recClass = '';
                }
                
                elements.statsGrid.appendChild(createStatCard(
                    'fa-balance-scale',
                    'Sa√∫de do Jogo',
                    `<div class="stat-value ${recClass}">${recommendation}</div>`,
                    `<span class="highlight">${weeklyHours.toFixed(1)}h/semana</span>. Recomendado: 10-20h/semana.`,
                    ''
                ));
                
                // 6. Jogos Diferentes
                elements.statsGrid.appendChild(createStatCard(
                    'fa-gamepad',
                    'Jogos Diferentes',
                    `<div class="stat-value">${games.length}</div>`,
                    `N√∫mero de jogos √∫nicos jogados nas √∫ltimas 2 semanas.`,
                    ''
                ));
                
                // 7. Jogo Mais Jogado
                if (games.length > 0) {
                    const topGame = games[0];
                    const shortName = topGame.name.length > 15 ? topGame.name.substring(0, 15) + '...' : topGame.name;
                    elements.statsGrid.appendChild(createStatCard(
                        'fa-crown',
                        'Jogo Favorito',
                        `<div class="stat-value small">${shortName}</div>`,
                        `<span class="highlight">${(topGame.playtime_2weeks / 60).toFixed(1)}h</span> jogadas recentemente.`,
                        ''
                    ));
                }
                
                // 8. Lista de Jogos
                if (games.length > 0) {
                    const gamesListCard = document.createElement('div');
                    gamesListCard.className = 'stat-card games-list';
                    gamesListCard.innerHTML = `
                        <h3><i class="fas fa-list-ol"></i> Jogos Mais Jogados (√öltimas 2 Semanas)</h3>
                        <div class="games-container" id="gamesContainer"></div>
                    `;
                    elements.statsGrid.appendChild(gamesListCard);
                    
                    const gamesContainer = document.getElementById('gamesContainer');
                    const maxHours = Math.max(...games.map(g => g.playtime_2weeks / 60));
                    
                    games.slice(0, 6).forEach(game => {
                        const hours = game.playtime_2weeks / 60;
                        const percentage = (hours / maxHours) * 100;
                        const percentOfTotal = totalHours > 0 ? ((hours / totalHours) * 100).toFixed(1) : '0';
                        
                        const gameElement = document.createElement('div');
                        gameElement.className = 'game-item';
                        gameElement.innerHTML = `
                            <div class="game-img">
                                <img src="https://cdn.cloudflare.steamstatic.com/steam/apps/${game.appid}/header.jpg" 
                                     alt="${game.name}"
                                     onerror="this.onerror=null; this.style.display='none'; this.parentElement.innerHTML='<i class=\"fas fa-gamepad\"></i>';">
                            </div>
                            <div class="game-info">
                                <div class="game-name" title="${game.name}">${game.name}</div>
                                <div class="game-hours">${formatHours(hours)} horas</div>
                                <div class="skill-bar">
                                    <div class="skill-name">
                                        <span>${percentOfTotal}% do total</span>
                                        <span>${(hours / 14).toFixed(1)}h/dia</span>
                                    </div>
                                    <div class="skill-progress">
                                        <div class="skill-fill" style="width: ${percentage}%"></div>
                                    </div>
                                </div>
                            </div>
                        `;
                        gamesContainer.appendChild(gameElement);
                    });
                }
            }
            
            // Exibir curiosidades divertidas (10+ itens)
            function displayFunFacts(totalHours, games) {
                elements.funFactsGrid.innerHTML = '';
                
                const facts = [
                    {
                        icon: 'fa-language',
                        title: 'Aprender um Novo Idioma',
                        content: `Com ${formatHours(totalHours)} horas, daria para alcan√ßar o n√≠vel b√°sico de um novo idioma como espanhol ou franc√™s!`,
                        color: 'var(--success)'
                    },
                    {
                        icon: 'fa-code',
                        title: 'Programa√ß√£o Web',
                        content: `Tempo suficiente para aprender HTML, CSS e JavaScript b√°sicos e criar seu primeiro site!`,
                        color: 'var(--accent)'
                    },
                    {
                        icon: 'fa-plane',
                        title: 'Viagem Internacional',
                        content: `Daria para viajar de S√£o Paulo at√© Lisboa ${Math.floor(totalHours / 10)} vezes!`,
                        color: 'var(--purple)'
                    },
                    {
                        icon: 'fa-dumbbell',
                        title: 'Transforma√ß√£o F√≠sica',
                        content: `Com ${Math.floor(totalHours * 2)} sess√µes de academia, daria para perder ${Math.floor(totalHours * 0.3)}kg!`,
                        color: 'var(--orange)'
                    },
                    {
                        icon: 'fa-book',
                        title: 'Leitura Intensa',
                        content: `Tempo para ler aproximadamente ${Math.floor(totalHours * 2)} livros de 300 p√°ginas!`,
                        color: 'var(--warning)'
                    },
                    {
                        icon: 'fa-film',
                        title: 'Maratona de Filmes',
                        content: `Daria para assistir ${Math.floor(totalHours / 2)} filmes completos da Marvel!`,
                        color: 'var(--danger)'
                    },
                    {
                        icon: 'fa-utensils',
                        title: 'Culin√°ria Profissional',
                        content: `Tempo suficiente para aprender ${Math.floor(totalHours / 3)} receitas gourmet do zero!`,
                        color: 'var(--highlight)'
                    },
                    {
                        icon: 'fa-music',
                        title: 'Aprender um Instrumento',
                        content: `Com ${formatHours(totalHours)} horas de pr√°tica, j√° estaria tocando v√°rias m√∫sicas no viol√£o!`,
                        color: 'var(--success)'
                    },
                    {
                        icon: 'fa-hiking',
                        title: 'Caminhada Extrema',
                        content: `Daria para caminhar de S√£o Paulo at√© Campinas ${Math.floor(totalHours / 20)} vezes a p√©!`,
                        color: 'var(--accent-dark)'
                    },
                    {
                        icon: 'fa-seedling',
                        title: 'Horta Completa',
                        content: `Tempo para cultivar ${Math.floor(totalHours / 5)} tipos diferentes de vegetais do plantio √† colheita!`,
                        color: 'var(--success)'
                    },
                    {
                        icon: 'fa-palette',
                        title: 'Curso de Arte',
                        content: `Suficiente para completar um curso b√°sico de desenho ou pintura digital!`,
                        color: 'var(--purple)'
                    },
                    {
                        icon: 'fa-car',
                        title: 'Aprender a Dirigir',
                        content: `Tempo total das aulas pr√°ticas necess√°rias para tirar a carteira de motorista!`,
                        color: 'var(--warning)'
                    },
                    {
                        icon: 'fa-swimmer',
                        title: 'Nadar o Canal da Mancha',
                        content: `Daria para nadar o equivalente a ${Math.floor(totalHours * 2)}km - quase o Canal da Mancha!`,
                        color: 'var(--accent)'
                    },
                    {
                        icon: 'fa-mountain',
                        title: 'Escalar o Everest',
                        content: `Tempo equivalente a ${Math.floor(totalHours / 40)} expedi√ß√µes de treino para o Everest!`,
                        color: 'var(--danger)'
                    },
                    {
                        icon: 'fa-chess',
                        title: 'Mestre de Xadrez',
                        content: `Com essa dedica√ß√£o, j√° estaria no n√≠vel intermedi√°rio-avan√ßado de xadrez!`,
                        color: 'var(--secondary)'
                    }
                ];
                
                // Selecionar 10 curiosidades aleat√≥rias
                const selectedFacts = facts
                    .sort(() => Math.random() - 0.5)
                    .slice(0, 10);
                
                selectedFacts.forEach(fact => {
                    const factCard = document.createElement('div');
                    factCard.className = 'fun-fact-card';
                    factCard.innerHTML = `
                        <h4><i class="fas ${fact.icon}" style="color: ${fact.color}"></i> ${fact.title}</h4>
                        <p>${fact.content}</p>
                        <div class="fun-fact-icon">
                            <i class="fas ${fact.icon}"></i>
                        </div>
                    `;
                    elements.funFactsGrid.appendChild(factCard);
                });
            }
            
            // Criar card de estat√≠stica
            function createStatCard(icon, title, value, description, extraClass = '') {
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.innerHTML = `
                    <h3><i class="fas ${icon}"></i> ${title}</h3>
                    <div class="stat-value ${extraClass}">${value}</div>
                    <p class="stat-description">${description}</p>
                `;
                return card;
            }
            
            // Usar dados de fallback
            function useFallbackData() {
                console.log('Usando dados de fallback');
                displayProfileInfo(SAMPLE_DATA.profile);
                const gamesData = { response: SAMPLE_DATA.games };
                processAndDisplayStats(SAMPLE_DATA.profile, gamesData);
                updateCacheInfo();
            }
            
            // Carregar dados do cache
            function loadCachedData() {
                const cachedProfile = cache.get('profile');
                const cachedGames = cache.get('games');
                
                if (cachedProfile && cachedGames) {
                    displayProfileInfo(cachedProfile);
                    processAndDisplayStats(cachedProfile, cachedGames);
                    updateApiStatus('warning', 'API: Usando dados do cache');
                } else {
                    useFallbackData();
                }
                updateCacheInfo();
            }
            
            // Atualizar info do cache
            function updateCacheInfo() {
                const info = cache.getInfo();
                elements.cacheInfo.textContent = `${info.count} itens em cache`;
            }
            
            // Event Listeners
            elements.refreshBtn.addEventListener('click', fetchSteamData);
            elements.clearCacheBtn.addEventListener('click', () => cache.clear());
            
            elements.shareBtn.addEventListener('click', () => {
                if (navigator.share) {
                    navigator.share({
                        title: 'Estat√≠sticas do Guigaum na Steam',
                        text: 'Confira as estat√≠sticas de jogo em tempo real do Guigaum!',
                        url: window.location.href
                    });
                } else {
                    navigator.clipboard.writeText(window.location.href);
                    showNotification('Link copiado para a √°rea de transfer√™ncia!');
                }
            });
            
            elements.themeToggle.addEventListener('click', () => {
                const isDark = document.body.classList.toggle('light-theme');
                elements.themeToggle.innerHTML = `<i class="fas ${isDark ? 'fa-sun' : 'fa-moon'}"></i>`;
            });
            
            // Inicializar
            updateCacheInfo();
            
            // Verificar cache primeiro
            const cachedStats = cache.get('stats');
            if (cachedStats && Date.now() - cachedStats.timestamp < CACHE_CONFIG.stats.ttl) {
                console.log('Carregando dados do cache...');
                loadCachedData();
            }
            
            // Buscar dados atualizados
            fetchSteamData();
            
            // Atualizar a cada 10 minutos
            setInterval(fetchSteamData, 10 * 60 * 1000);
            
            // Verificar conex√£o a cada minuto
            setInterval(() => {
                if (appState.isOnline !== navigator.onLine) {
                    appState.isOnline = navigator.onLine;
                    if (appState.isOnline) {
                        fetchSteamData();
                    }
                }
            }, 60 * 1000);
        });
    </script>
</body>
</html>
